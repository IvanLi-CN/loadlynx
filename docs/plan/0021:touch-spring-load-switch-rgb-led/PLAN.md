# 触摸弹簧（GPIO14）负载开关 + RGB PWM 指示灯（0021）

## 状态

- Status: 待设计
- Created: 2026-01-19
- Last: 2026-01-20

## 背景 / 问题陈述

- 该计划已在 `docs/plan/README.md` 中分配了编号与索引行，但缺少对应的 `PLAN.md`，会导致计划索引一致性校验失败。
- 本文件用于补齐计划骨架，后续再进入需求冻结与实现排期。

## 目标 / 非目标

### Goals

- 明确 GPIO14 触摸弹簧输入的交互语义（点击/长按/去抖/误触处理等）。
- 明确“负载开关”控制的职责边界（digital/analog 各自做什么）与安全策略（默认态、上电态、异常态）。
- 明确 RGB PWM 指示灯的状态机与颜色/亮度规范（例如：待机/输出启用/告警/故障/Link down）。
- 冻结验收标准（Given/When/Then + 边界/异常）与测试策略。

### Non-goals

- 不在本计划文件中直接实现功能；实现应在 Status 进入 `待实现` 后再开始。

## 范围（Scope）

### In scope

- GPIO14 触摸弹簧输入：事件定义、去抖策略、状态上报方式（TBD）。
- 负载开关控制：安全策略与与现有控制流的集成点（TBD）。
- RGB PWM 指示灯：状态映射、亮度/PWM 频率约束、与故障/保护的优先级（TBD）。
- 相关文档与接口契约（如需新增/调整）。（TBD）

### Out of scope

- 与本功能无关的 UI 视觉重构或协议扩展。

## 需求（Requirements）

### MUST

- 给出明确的交互语义与状态机（触摸弹簧 / 负载开关 / RGB 指示灯）。
- 给出可验证的验收标准与测试策略（含异常/边界）。

### SHOULD

- 尽量复用既有状态源（fault/uv_latch/link_up 等）进行指示灯映射，避免重复逻辑。

### COULD

- 支持调试入口（例如在 mock/devtools 中注入触摸/故障状态进行可视化验证）。

## 验收标准（Acceptance Criteria）

- TBD（待需求冻结后补齐）

## 里程碑（Milestones）

- [ ] M1: 需求与交互语义冻结
- [ ] M2: 接口/职责边界冻结（digital/analog + 协议/HTTP）
- [ ] M3: 验收标准冻结（含异常与测试策略）
- [ ] M4: 实现 + 自测（按仓库既有质量门槛）

## 风险与开放问题（Risks & Open Questions）

- 需要确认：GPIO14 的硬件接线/上拉下拉/中断触发方式，以及与现有输入资源是否冲突。
- 需要确认：负载开关在异常（过流/过温/Link down）时的强制策略与恢复流程。
- 需要确认：RGB LED 的功耗/亮度/PWM 频率约束与可视化可读性。

